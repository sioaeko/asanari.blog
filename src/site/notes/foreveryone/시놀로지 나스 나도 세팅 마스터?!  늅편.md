---
{"dg-publish":true,"permalink":"/foreveryone//"}
---


# <span style="color:red">목차</span>

- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#1장 : 시놀로지 나스를 꼭집어 사는 이유\|1장 : 시놀로지 나스를 꼭집어 사는 이유]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#1장 : 시놀로지 나스를 꼭집어 사는 이유\|왜 시놀로지 나스냐고?]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#1장 : 시놀로지 나스를 꼭집어 사는 이유\|ASUS의 아픈 손, Asustor NAS]]
- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#2장 : 털리고싶지 않은 자, 기본적인걸 대비해라\|2장 : 털리고싶지 않은 자, 기본적인걸 대비해라]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#2장 : 털리고싶지 않은 자, 기본적인걸 대비해라\|리눅스로서 가장 취약한 보안 - ssh]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#2장 : 털리고싶지 않은 자, 기본적인걸 대비해라\|기본 포트는 저희 업계에서도 거릅니다]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#2장 : 털리고싶지 않은 자, 기본적인걸 대비해라\|방화벽의 중요성]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#2장 : 털리고싶지 않은 자, 기본적인걸 대비해라\|우린 이런 서비스는 받지않습니다.]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#2장 : 털리고싶지 않은 자, 기본적인걸 대비해라\|Synology 도메인을 받아보자]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#2장 : 털리고싶지 않은 자, 기본적인걸 대비해라\|세상 쉬운 SSL 인증서를 적용해보자.]]
- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#3장 : 우린 한떄 최적화에 미쳤었죠\|3장 : 우린 한떄 최적화에 미쳤었죠]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#3장 : 우린 한떄 최적화에 미쳤었죠\|하드디스크는 무엇을 사야할까?]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#3장 : 우린 한떄 최적화에 미쳤었죠\|레이드는 뭐가 좋을까?]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#3장 : 우린 한떄 최적화에 미쳤었죠\|캐싱 SSD, 꼭 필요한가?]]
- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#4장 : 이제 밖으로 나가볼까?\|4장 : 이제 밖으로 나가볼까?]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#4장 : 이제 밖으로 나가볼까?\|나스를 밖에서 안전하게 사용하기]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#4장 : 이제 밖으로 나가볼까?\|WebDAV가 대중적으로 쓰이는 이유]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#4장 : 이제 밖으로 나가볼까?\|포트포워딩이 과연 정답일까?]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#4장 : 이제 밖으로 나가볼까?\|진짜 정답은 가상사설망에 있다.]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#4장 : 이제 밖으로 나가볼까?\|QuickConnect가 뭐길래 안쓰는걸까?]]
- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#5장 : 시놀로지의 본질 기능 활용하기\|5장 : 시놀로지의 본질 기능 활용하기]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#5장 : 시놀로지의 본질 기능 활용하기\|Synology Photo]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#5장 : 시놀로지의 본질 기능 활용하기\|DS File]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#5장 : 시놀로지의 본질 기능 활용하기\|DS Get 대체앱 - DS Download]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#5장 : 시놀로지의 본질 기능 활용하기\|DS Video]]
- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#6장 : 아직 시작도 안했는걸\|6장 : 아직 시작도 안했는걸]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#6장 : 아직 시작도 안했는걸\|Hyper Backup]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#6장 : 아직 시작도 안했는걸\|Snapshot Replication]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#6장 : 아직 시작도 안했는걸\|VMM ( Virtual Machine Manager )]]
- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|7장 : Docker]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|Docker가 뭐지?]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|Kubernetes는 도커랑 뭐가 다르지?]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|시놀로지 Docker가 특별한 이유]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|시놀로지 Docker의 새 이름 : Container Manager]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|Portainer는 뭐지?]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|하지만 새로운 Container Docker는 다르다]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|시놀로지 Docker의 간단한 사용법]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|시놀로지 도커의 주의사항]]
	- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#7장 : Docker\|시놀로지 Docker에 간단하게 Ubuntu 올려보기]]
- [[foreveryone/시놀로지 나스 나도 세팅 마스터?!  늅편#늅편을 마무리하며...\|늅편을 마무리하며...]]


## 1장 : 시놀로지 나스를 꼭집어 사는 이유
### 왜 시놀로지 나스냐고?

- 왜 모두가 시놀로지 나스를 사는걸까? 나스 업계에는 ASUSTOR, QNAP, Synology까지 꽤나 역사 깊은 브랜드들이 존재한다. 다만 시놀로지 이외에 회사들은 나스 매니아, 홈랩 관리자들에게 큰 환영을 받지 못한다.
- 지금부터 왜 시놀로지가 더 낮은 하드웨어에 사악한 가격 정책임에도 압도적인 인기를 누리고있는지 알려주고자 한다.

### ASUS의 아픈 손, Asustor NAS

- asustor는 이름에서 볼수있다시피 ASUS사의 NAS 브랜드이다. 당연히 대기업의 브랜드임으로 기본적으로 이미지가 나쁜편이 아니였다. QNAP또한 크게 차이가 나지않기 때문에 함께 묶어서 설명하고자한다.

- 하드웨어적인 이점은 Asustor가 훨씬 좋았기때문에 일부 매니아들에겐 asustor도 나쁘지않은 선택지라는 선입견이 있었으나 이것 또한 추후 설명할 #2022년 사건에 의해 신뢰성과 인지도가 완전히 사그라지며 현재는 NVME SSD 나스 같은 특이 상품만이 명목을 이어나가고있다.(HDD 나스군도 꾸준히 출시중이나 예전같은 인지도를 받지못한다.)
![AS-204TE_L2.png|200x200](/img/user/AS-204TE_L2.png)
- 위가 대표적인 asustor의 나스의 모습이다, 이쁘다는 느낌보다는 공돌이 감성이 가득하다고 볼수있다.(RGB/상태 디스플레이)

- 툭히 저 베젤안에 있는 디스플레이로 보여지는 내부 주소창과 메세지창은 일부 매니아의 감성을 자극하기에 충분했다.
![AS6204T_F.png|200](/img/user/AS6204T_F.png)

- 하지만 이 소개서는 #asustor 를 소개하고자하는 소개서가 아니기에 지금부터 두 가지 이유로  asustor가 인지도와 인기를 잃어버린 원인을 알려주고자 한다.

![overview1.png](/img/user/overview1.png)

- 시놀로지 나스 대비 상당히 구린 UI 인터페이스와 앱 지원성
  이 점은 QNAP에도 동등하게 적용되는 바이다, 시놀로지 나스 대비해서 유저 인터페이스와 개발자를 위한 지원성, 일반 사용자를 위한 나스 앱 연동성까지 모든 부분에서 떨어지다못해 구리다.
  OS의 확장성/사용성 모두를 잡지못한 케이스이고 예전까지만 하더라도 하드웨어/가격 덕분에 어느정도의 시놀로지와 타협/비교가 이루어지긴했으나 마찬가지로 #2022년 사건을 기점으로 완전히 저물게 되었다.


![banner.png|400](/img/user/banner.png)

위는 현재 시놀로지의 최근 릴리스인 DSM 7.2의 데스크탑 UI이다.
세부적인 부분을 보지않더라도 사실상 완전히 다르다는걸 알수있다.
DSM 인터페이스는 윈도우/맥을 사용했던 사용자에겐 매우 친숙하게 사용할수있는 UI이며
설정에서 보여질 컨트롤 패널또한 리눅스 기반치고 직관적이고 복잡하지않다.

- 당신이 QNAP과 Asustor를 고르지 말아야 했을 대표적인 이유이자 두 회사의 제품군이 완전히 몰락한거에 큰 기여를 한 #2022년 2월달부터 시작된 QNAP,Asustor를 타켓으로 한 랜섬웨어 DeadBolt 사건이 벌어지게 된다.

-  2022년 DeadBolt 사건

![img.png|400](/img/user/img.png)

- 이를 단순히 여겨서는 안되는 이유가 소수의 사용자가 감염된것이 아닌 상당수의 해당 나스군(QNAP,Asustor) 사용자들이 감염을 당했던 랜섬웨어였다. 유명 유튜버/블로거 등들도 해당 랜섬웨어로 나스의 자료가 통쨰로 날아가 큰 피해를 입기도했었다

- 하지만 이 Deadbolt는 시놀로지를 타켓으로 하지못했다는 점에서 두 회사와 시놀로지의 보안적인 면모의 차이가 드러나기도했다.

- 참고로 시놀로지는 Snapshot Replication이라는 랜섬웨어의 공격을 받기전으로 파일 변경상황을 되돌리는 중요한 기능을 제공하고있기 때문에 만에 하나 같은 네트워크에서 사용중인 PC에서 랜섬웨어가 걸린다하더라도 충분히 롤백할수있는 상황이었다 ( 당연히 스냅샷또한 완벽한 대비책은 아니기에 2차 백업은 필수이다..)

- 대처 방법또한 윈도우 랜섬웨어 사태떄와 별 다를바 없던 허접한 대비 방법뿐이였고, 추후 Deadbolt의 암호 해독키를 입력하여 복호화를 풀 방법을 asus에서 공지했으나 이미 그떄는 7월달이였고, 그 전에 이미 많은 사용자들이 시놀로지로 발길을 돌리게 되었다.

## 2장 : 털리고싶지 않은 자, 기본적인걸 대비해라
### 리눅스로서 가장 취약한 보안 - ssh
![Screenshot 2023-11-16 at 2.47.39 AM.png|450](/img/user/Screenshot%202023-11-16%20at%202.47.39%E2%80%AFAM.png)
- 아무리 시놀로지의 보안이 좋다고 떠든다한들, 시놀로지도 결국 리눅스다.
  보안적인 취약점이 존재할수밖에 없는 OS이고 그걸 보안패치와 지속적인 지원,대비책으로 커버치는 회사다.
  그 중에서도 리눅스에서 기본값으로 가만히 방치해두면 안되는 부분이 있는데, 바로 ssh이다.
  
- SSH는 리눅스를 다뤄봤던 사람이면 무조건 알수있는 원격 터미널 서비스이다.
바로 리눅스와 같은 터미널 환경을 원격 접속을 이용하여 사용할수 있도록 고안된 보안 프로토콜중 하나이다

- 시놀로지는 참고로 Telnet과 ssh를 둘 다 지원하고있으나 Telnet는 일반 문자열을 출력할떄 암호화를 거치지않고 평문으로 전송되기 때문에 네트워크 패킷 감청/캡처를 통해서 중요한 정보가 탈취당할수있다는 큰 보안적 결함이 있어 사용하지않는걸 추천한다.

- 그렇다고 ssh가 보안에 매우 특화된 프로토콜이냐고 하면, 그건 반은 맞고 반은 틀린것이다.
기본적으로 ssh 프로토콜은 일반 문자열을 출력할때 식별할 수 없는 내용으로 패킷을 복호화하여 통신해서 Telnet 대비 보안이 좋은 편에 속하지만, ssh의 기본 포트가 22로 정해져있다는 점에선 보안이 좋다라고 볼수없다.
### 기본 포트는 저희 업계에서도 거릅니다

- ssh 파트와 같이 설명할 기본 포트는 보안에 치명적이다못해 사실상 모든걸 개방하고있겠다는 뜻으로 설명해도 할말이 없다, 기본적으로 나스를 공격하는 크래커들은 기본적으로 ssh, ftp, webdav 같은 중요한포트들이 개방되있는 포트스캔을 거치는데, 기본 포트를 사용하게 된다면 포트스캔에 걸리는건 첫번쨰 문제이며 그들은 brute-force attack을 통해서 들어오기 떄문에 자칫 root 계정의 로그인이 풀려 나스의 모든 권한을 장악당할수 있다.

-  당연하게도 시놀로지에서 기본으로 세팅되있는 모든 포트들은 기본값으로 설정되있기 떄문에, 위 위협들에 상당히 노출되게 된다.

- 그걸 조금이라도 방지하고자 제어판에서 ssh 서비스의 포트를 다른걸로 바꾸고 안쓸떄는 비활성화를 해두고 Telnet는 무조건적으로 비활성해둔다

- 이는 WebDAV, FTP, SFTP, rsync, DSM HTTP/HTTPS 접속 포트에도 해당하기 때문에 위에 해당하는 포트들은 전부 다른걸로 수정해두는걸 추천한다.

![Screenshot 2023-11-16 at 2.01.43 AM.png|500](/img/user/Screenshot%202023-11-16%20at%202.01.43%E2%80%AFAM.png)

- 제어판 > 보안 > 보호 > 자동 차단 > 자동 차단 활성화
   제어판 > 보안 > 서비스 거부(DoS) 보호 활성화
   제어판 > 보안 > 사이트 간 위장 공격에 대한 보호 기능 향상
   제어판 > 보안 > iFrame과 함께 DSM이 포함되도록 허용하지 않음
   
### 방화벽의 중요성

![Screenshot 2023-11-16 at 2.03.17 AM.png|500](/img/user/Screenshot%202023-11-16%20at%202.03.17%E2%80%AFAM.png)

- 이 방화벽이라는 존재가 어떻게보면 시놀로지 보안의 가장 큰 축을 담당한다고해도 무방하다.
- 이 방화벽만 잘 구성해두면 외부에서 오는 공격의 90%는 차단할수있다고 볼수있다.

- 해당 방화벽에는 한국을 제외한 모든 국가를 13개씩 묶어서 작업-거부를 해두면 된다.
   다만 자신이 추후 Ngnix Proxy Manager나 CDN 도메인 서비스와 묶어서 사용할 목적이 있다면 미국,일본 국가또한 한국와 함꼐 작업-허용을 걸어두면 된다.


### 우린 이런 서비스는 받지않습니다.

![Screenshot 2023-11-16 at 2.10.51 AM.png|500](/img/user/Screenshot%202023-11-16%20at%202.10.51%E2%80%AFAM.png)

- 아까 설명했던 Telnet과 함께 지금은 보안적인 취약점으로 사용하면 안되는 서비스가 있다.
- 대표적으로 애플의 AFP가 있다, AFP는 애플이 SMB를 대체하고자 만든 원격 서버 프로토콜이다.
> https://kb.synology.com/ko-kr/DSM/tutorial/file_protocol_AFP_not_recommended

- 다만 macOS 11.0 Big Sur부터는 애플에서 더 이상 AFP 서버를 지원하지않게 되며 보안적으로 더욱 더 취약해질 예정인 프로토콜이고 원격 환경에 SMB 서비스를 노출하는거 자체가 좋은 생각이 아니기 떄문에
   이 서비스는 무조건 비활성해두기로 하며 원격 SMB에 관한 해답도 4장에서 다뤄보기로한다.
### Synology 도메인을 받아보자

![Screenshot 2023-11-16 at 2.14.13 AM.png|400](/img/user/Screenshot%202023-11-16%20at%202.14.13%E2%80%AFAM.png)

- 사실상 이 기능이 시놀로지 나스를 사게 만든 이유중 하나라고 볼수있다.
- 사용 방법은 간단하게 제어판 > 외부 엑세스 > DDNS에서 추가하면 된다.
### 세상 쉬운 SSL 인증서를 적용해보자.

- 이 또한 간단하게 위 단계에서 Let's Encrypt에서 인증서를 가져오고 기본 인증서로 설정을 체크하고 확인을 하면 된다.
- 기본적으로 Let's Encrypt의 무료 R3 인증서는 3개월에 한번씩 재갱신을 해줘야되나 시놀로지사에서 자동 갱신을 해주기떄문에 걱정할 필요없이 쭉 사용하면 된다. ( 2021년까지는 X3 인증서를 발급했으나 해당 인증서를 Let's Encrypt 제단에서 지원 중단하게 되면서 현재는 R3 인증서를 발급해주고있다 )
https://letsencrypt.org/docs/dst-root-ca-x3-expiration-september-2021/


## 3장 : 우린 한떄 최적화에 미쳤었죠
### 하드디스크는 무엇을 사야할까?

- 나스를 구매하게 된다면 가장 크게 고민하게 되는 부분이기도하다, 바로 나스용 하드디스크다.
- 처음에는 하드디스크의 종류에 대해 크게 관심을 가지지 않을수도있으나 조금이라도 안정성에 대해 생각하게 된다면 바로 데이터센터/나스용 하드를 알고보게 될것이다.

![Screenshot 2023-11-16 at 2.26.08 AM.png|600](/img/user/Screenshot%202023-11-16%20at%202.26.08%E2%80%AFAM.png)

-  개인적인 경험으로서 추천은 WD 울트라스타이다, 말을 할 이유도 없는 매우 높은 캐시메모리,RPM,헬륨 밀봉,CMR까지 괜히 데이터센터용으로 납품하는게 아닌 최상급 하드군으로 볼수있다.
- 필자가 가장 잘 쓰고있는 라인업이기도하나 플레터 소리가 좀 큰 편에 속하기 떄문에 소음에 민감한 사람은 피하도록 하자.
- 다만 가장 큰 단점은 개인이 감당하기 힘든 가격이라고 볼수있다. 14테라 4개를 달기만해도 200만원이라는 거금을 바로 투척해야되며 하드는 #소모품 이다. 즉 계속 비슷한 혹은 똑같은 제품으로 대체/구비해둬야하는 점에서 이 선택지는 상당히 무리가 올수 있다.

![WD80EMAZ.jpg|200](/img/user/WD80EMAZ.jpg)

- 그래서 다른 대체제를 제안하자면 바로 엘리먼트 뽑기로 유명한 WD 화이트 하드이다.
- 주로 11마존,뉴에그,아마존 블프떄마다 돌아오는 유명한 가성비 하드 뽑기 연례 행사였으나, 지금은 환율 이슈 + 할인율 저하로 인해 전보다는 가성비가 상당히 안 좋아지긴했다.
-   하지만 여전히 WD Elements 12TB를 살 돈으로 정발에선 WD Red Plus 8테라밖에 없을 정도로 차이가 꽤나 나기 떄문에 개인적으로 이 하드의 적출품이나 미개봉품을 구하는걸 추천한다.
- 당연히 울트라스타와 비교한다면 성능적으로 차이나는 부분이 있겠으나 일반적인 환경에서는 크게 체감될 성능 차이가 아니며 오히려 화이트도 과할수도있다.
- 하지만 엘리먼트 외장케이스에서 적출한 제품은 RMA를 받을수없기 떄문에(재조립후 RMA를 보낼수있다.) 이 점은 주의해야하며 AS를 중요하게 여긴다면 차라리 Red Plus 정발 / 울트라스타 정발을 강력 추천하고자한다. ( 시게이트 바라쿠타 프로또한 도입을 했던바가 있으나 개인적으로 절대 추천하지않는다. )

### 레이드는 뭐가 좋을까?

![Screenshot 2023-11-16 at 2.40.50 AM.png|500](/img/user/Screenshot%202023-11-16%20at%202.40.50%E2%80%AFAM.png)

- 초반부터 결론을 얘기하자면 불안정한 소프트 레이드 구성은 하지않는걸 추천한다.
   즉 이 말은 단일 볼륨을 1,2,3,4 ~ 나눠서 따로 쓰는걸 추천한다는것이다.
   물리적인 레이드 카드같은 수단이 아닌 이상 그 안정성을 보장할수없다는게 가장 큰 이유이며
   제일 중요한건 레이드를 매칭할 조합이 상당히 에매하는 점이 있다.

![Screenshot 2023-11-16 at 2.41.44 AM.png|400](/img/user/Screenshot%202023-11-16%20at%202.41.44%E2%80%AFAM.png)
   
- 구지 레이드를 해야하겠다고 한다면 개인적으로는 레이드 1 + 백업용 나스를 구비하는걸 추천한다.
   사실상 백업용 나스를 구비할 정도면 그냥 RAID 0이나 단일 볼륨을 써도 무방하나 모든것에는 예외 사항이라는게 생기기 마련이기 떄문에, 개인적으로는 저 조합을 추천한다.
   
- 필자는 14테라 4개를 레이드5로 묶어서 14테라 분량을 미러 분량으로 두고 따로 해당 나스를 백업해줄
서브 나스를 같이 운영하고 있다.

> https://www.synology.com/ko-kr/support/RAID_calculator
- 직접 사용할 HDD 용량 조합을 넣어서 RAID를 계산해보는것도 좋은 방법이다.

### 캐싱 SSD, 꼭 필요한가?

결론부터 얘기하자면, 필수는 아니다.
다만 체감이 확 드는 영역은 아니나 있으면 손해를 보진않을것이다.
나는 SK 하이닉스의 BC711 256GB 2개를 캐싱용 SSD로 넣어두었다.
일단 어딘가에는 도움이 될거라는 마음으로 넣어놨으나 실상 체감이 되진않는다.
한가지 있다면 다른 사용자와 동시에 다른 자료를 받거나 불러올떄 속도를 유지시켜준다는 점이 있다.

## 4장 : 이제 밖으로 나가볼까?
###  나스를 밖에서 안전하게 사용하기

- 자신의 소중한 사진, 자료, 정보, 이력등을 남기는 나스를 외부에 노출해놓고 쓰는것만큼 불안하고 위험한게 따로 없다.
- CDN를 별도로 거치지않고 시놀로지 도메인을 쓸 경우엔 공인ip/포트또한 고스란히 공개되고 그 만큼 공격 대상이 되기 좋은 환경이 된다.

- 하지만 나스의 의미는 외부 접속에서 오는바, 그렇기에 외부 접속을 무작정 포기하는건 좋은 방법이 아니다.
그렇기에 필자가 적절한 합의점을 찾아주고자 한다.
### WebDAV가 대중적으로 쓰이는 이유

- 일단 WebDAV 정도는 포트포워딩해서 사용하는걸 추천한다.
- HTTPS 프로토콜로 통신하는 WebDAV 정도는 기본 포트만 활용하지않으면 공격에 취약하게 노출되지않으며 영상 플레이어나 파일앱에서 나스를 연결할떄 가장 잘 사용되는 서비스이기 때문에 무조건 시놀로지를 사게 된다면 WebDAV Server를 깔고 포트를 수정하고 해당 포트를 포트포워딩을 해서 사용하는걸 추천한다.
###  포트포워딩이 과연 정답일까?

- 포트포워딩만이 공인ip밖으로 해당 포트로 통신할수있는 유일한 수단이라고 생각한다면 오산이다.
- VPN 즉, 개인사설망으로 해당 망안에서는 노드로만 통신할수있게 만드는 좋은 방법이 존재한다.
### 진짜 정답은 가상사설망에 있다.

![WireGuard.png|300](/img/user/WireGuard.png)

- 그렇기에 시놀로지는 Zerotier,Tailscale,Wireguard같은 개인사설망 서비스를 열정적으로 지원하고있다.

- 사용하는 목적에 따라 다르겠지만 셋 다 사용했던 입장에서는 속도를 우선으로 한다면 Wireguard를 구축하는걸 추천하며 편의성을 우선으로 하고 내부 노드의 관리가 더 쉬운쪽을 택하고 싶다면 Tailscale를 추천한다.

- SMB 서비스또한 zerotier,tailscale,wireguard를 통해 보안에 위협받지않으면서 외부에서 접근할수있기 떄문에 무조건 포트포워딩으로 개방하는 방식을 택하지않는걸 추천한다.
- 이번 편은 늅편이기 때문에 이 가상사설망에 대한 자세한 구축 방식은 여기에 기제하지않았다.

###  QuickConnect가 뭐길래 안쓰는걸까?

![04.png|500](/img/user/04.png)

- 퀵커넥트는 포트포워딩을 사용하지않고 외부에서 접근할수있는 또 다른 선택지이기도하다.

- 퀵커넥트는 포트포워딩 없이 시놀로지의 본사인 홍콩 서버를 경유하여 집에 있는 나스를 접근하는 방식으로 도메인이 퀵커넥트 도메인으로 숨겨지기 때문에 보안성 자체로는 매우 훌륭하다

- 하지만 경유 서버가 홍콩 서버밖에 없는 만큼 한국에서 사용시 말도 안되는 DSM 반응 속도, 극악의 파일 전송 속도등의 단점으로 인해 결국엔 비활성화하고 쓰게 될것이다.
##  5장 : 시놀로지의 본질 기능 활용하기
### Synology Photo

![C4802C6C-279D-4011-A004-9B96885E9EFE_4_5005_c.jpeg|300](/img/user/C4802C6C-279D-4011-A004-9B96885E9EFE_4_5005_c.jpeg)

- DSM 7.0 대규모 업데이트 당시에 새로 리뉴얼된 시놀로지 포토이다.
- UI는 상당히 깔끔하며 여기서 사진을 업로드하거나 다운로드받을수있다.

- 참고로 Photo Statin에는 얼굴인식 기능이 포함되있으며 정품 시놀로지는 어떤 문제 없이도 CPU와 내장GPU를 갈궈서 사용하게된다. ( 해놀로지는 별도의 플러그인 모델을 설치하여 패치해야한다. )
### DS File

![KakaoTalk_Photo_2023-11-16-16-48-10.jpeg|300](/img/user/KakaoTalk_Photo_2023-11-16-16-48-10.jpeg)

- DSM 7.0 대규모 업데이트에 포함되지않은 구형 파일앱이다.
다만 구형 UI도 쓰는데는 크게 문제없는 편이라 잘 사용하는 편이다.

- UI가 그래도 마음에 들지않는다면 Solid Explorer같은 사제 파일 관리앱에 webdav로 나스를 추가해서
사용하면 된다.

### DS Get 대체앱 - DS Download

![IMG_2450.png|400](/img/user/IMG_2450.png)

- 사실 IOS버전에는 DS Download 공식 앱이 없다, 위에 사진은 다른 개발자가 만들어둔
유로 DS Download 앱이다. 다만 UI적으로나 기능적으로나 안드로이드판 구형 DS get와는 갭차이가 매우 심하며
실리콘 맥과 아이패드도 지원하기 때문에 평생 18000원이라는 가격이 크게 부담으로 다가오지않을것이다.

- 위에 사제 Download 앱은 위젯도 지원하기 떄문에 토렌트가 다운받아지는 현황을 체크하기도 쉽다.


![unnamed.webp](/img/user/unnamed.webp)
### DS Video

![스크린샷 이미지](https://play-lh.googleusercontent.com/LAAqmQqwSofqNqXwx3PTKzVag6NjphxKmUh49uRNYnugK17t4ZCFChcLq-nv9COTWA=w526-h296-rw)

- 단호하게 이 서비스는 손을 대지않았으면 한다. UI를 뒤로 접어두고 본다하더라도 코덱 지원성이 다른 오픈소스 비디오 서버 플랫폼들과 비교해서도 압도적으로 떨어진다.

- 필자는 Infuse 7를 영구 플랜으로 끊어서 사용중이다. Infuse에 관련된 얘기는 안해도 알 만한 애플 생태계중엔 가장 끝판왕 NAS 영상 플레이어이다. 어떤 OTT에도 꿇리지않은 UI부터, 메타데이터를 잘 가져와서 정리해주는 능력, 그외에 성우 정보까지 세세한 점까지 전부 정리해주는 말그대로 끝판왕 앱 중 하나이다.

- 단점은 제정신이 아닌 영구결제 가격이나 1년 구독료자체는 가격이 나쁘지않은 편이라 고려해보는걸 추천한다.

![77fddb84d117c706c57a4155008f7453SfI5B.jpg](/img/user/77fddb84d117c706c57a4155008f7453SfI5B.jpg)
## 6장 : 아직 시작도 안했는걸
### Hyper Backup

![Screenshot 2023-11-16 at 5.07.47 PM.png](/img/user/Screenshot%202023-11-16%20at%205.07.47%E2%80%AFPM.png)

- 아직 이 단계에서는 이 백업이라는 수단에 대해 중요성을 크게 깨달지못한다.
그렇기 때문에 6장의 첫번쨰 내용에 하이퍼 백업을 수록하기로 했다.
시놀로지 나스가 아무리 안정성이 좋다고 해도 결국 소프트 레이드 or 자체 하드 레드섹터/CRC 오류등의 많은 변수들이 자료를 한순간에 안드로메다로 보내버릴수있다.
그렇기에 백업이라는 수단은 나스에게는 무조건 필수로 여겨지는 바이다. 허나 이번에 나스를 새로 산 사람에게
백업용을 위한 또 다른 나스와 하드를 사라고 할순없는 바. 

![Screenshot 2023-11-16 at 5.10.58 PM.png|450](/img/user/Screenshot%202023-11-16%20at%205.10.58%E2%80%AFPM.png)

- 그래서 추천하는 방식은 바로 외장하드/SSD를 나스에 물려서 백업 설정을 해두는것이다.

![Screenshot 2023-11-16 at 5.13.36 PM.png|450](/img/user/Screenshot%202023-11-16%20at%205.13.36%E2%80%AFPM.png)

- 백업 유형은 여러 버전으로 해두는걸 추천한다, 사실상 나중에 자료를 다른 os에서 접근해서 빼내고싶다면 
- 아래에 있는 단일 버전을 선택하는게 좋으나 여러 버전이 공간 효율이 좋아서 용량이 넘쳐흐르는 사람은 단일 버전을 용량을 효율적으로 쓰고싶은 사람은 여러 버전을 선택하는걸 추천한다.

![Screenshot 2023-11-16 at 5.14.13 PM.png|400](/img/user/Screenshot%202023-11-16%20at%205.14.13%E2%80%AFPM.png)

![Screenshot 2023-11-16 at 5.14.44 PM.png|450](/img/user/Screenshot%202023-11-16%20at%205.14.44%E2%80%AFPM.png)

- 이렇게 원하는 스케줄을 맞춰서 백업을 올려두면 된다. 그럼 나스가 정해진 시간떄마다 자동으로 외장하드에 백업 파일을 업로드해줄것이다.
### Snapshot Replication

![Screenshot 2023-11-16 at 5.18.41 PM.png](/img/user/Screenshot%202023-11-16%20at%205.18.41%E2%80%AFPM.png)

- 스냅샷 레플리카는 1장에서 다뤘다시피 랜섬웨어 혹 관리하는 사람의 실수를 만회할수있는 좋은 대비책이다.
말그대로 해당 폴더에 있던 파일의 변경 이전의 상태를 미리 찍어놓고 나중에 문제가 발생했을떄 해당 지점으로 되돌릴수있는 아주 중요한 서비스중 하나다.

![Screenshot 2023-11-16 at 5.20.47 PM.png|450](/img/user/Screenshot%202023-11-16%20at%205.20.47%E2%80%AFPM.png)

![Screenshot 2023-11-16 at 5.21.08 PM.png|450](/img/user/Screenshot%202023-11-16%20at%205.21.08%E2%80%AFPM.png)

- 개인적으로 이렇게 스케줄 예약을 해놓고 사용하는걸 추천한다.
아래에 변경할 수 없는 스냅샷은 걸어두면 해당 보호 기간동안은 어떠한 권한으로도 해당 스냅샷이 찍힌 폴더를 
삭제시킬수 없기 때문에 해당 옵션은 필요한 폴더만 따로 스냅샷을 찍는것을 추천한다.
### VMM ( Virtual Machine Manager )

![Screenshot 2023-11-16 at 5.25.41 PM.png](/img/user/Screenshot%202023-11-16%20at%205.25.41%E2%80%AFPM.png)

이 VMM의 기능또한 앞으로도 사용 할 일이 적을것으로 생각한다.
그렇게 생각하는 이유는 두 가지이다.
  1. 개인용 시놀로지의 성능 낮은 저전력 CPU
  2. 네이티브 화면 출력이 아닌 VNC 출력
  3.  캐시SSD 없는 하드디스크를 사용하는 경우가 많음
  
![Screenshot 2023-11-16 at 6.12.09 PM.png](/img/user/Screenshot%202023-11-16%20at%206.12.09%E2%80%AFPM.png)

그렇기에 해당 기능은 DS1621+급 이상이나 고성능 해놀로지 구축 사용자만 사용하는걸 추천한다
(920+ 정도도 실사하기 벅차다)

- 참고로 VNC 출력을 사용하지않고 윈도우내에 별도의 리모트 프로그램(팀뷰어,크롬 리모트)나 RDP를 구축하는 방법도 존재한다.

- 다만 RDP로 접속한다하더라도 CPU 자체가 꽤나 저 사양이기떄문에 윈도우 자체의 버벅임떄문에 사용을 접게될것이다. ( 그렇기에 제온 라인업 이상 사용자에게만 추천하는 서비스이다.)

## 7장 : Docker

* 시놀로지 나스의 하이라이트인 Docker에 대해 서술한 챕터이다.
### Docker가 뭐지?

![froala-uploads-1653627056791-수정됨-vertical-logo-monochromatic.png|200](/img/user/froala-uploads-1653627056791-%EC%88%98%EC%A0%95%EB%90%A8-vertical-logo-monochromatic.png)

역사에 대한 부분은 생략하고 도커는 오픈소스 컨테이너 플랫폼이라고 보면 된다.
개발자가 컨테이너를 빌드, 배포하여 실행할수있도록 지원하는 상용 컨테이너화 플랫폼 및 런타임 서비스라 보면 된다. 단일 API를 통해서 간단한 명령과 자동화를 가춘 클라이언트-서버 아키텍처를 사용하며 도커가 없던 시절에도 컨테이너를 만들순있었으나 지금의 Docker로 인해 많은 개발자,DevOps들이 더 빠르고 원할하고 저렴하게 컨테이너를 구축하여 서비스를 배포할수있게 되었다.

특히 도커는 LXC 기술을 활용하기 떄문에 리눅스를 기반으로 구동되는 컨테이너임에도 램 점유율이 상당히 낮다는 큰 이점을 가지고있다.
LXC 기술은 컴퓨터와 독립적인 컴퓨팅 공간을 분리해서 만드는데, 하이퍼바이저를 사용해서 여러개의 OS를 가상화로 바꿔버리는 VM(가상머신)과 달리 도커의 LXC 컨테이너는 호스트 OS(Linux)의 커널을 공유하여 하나의 격리된 컨테이너로서 작동하기 때문에 가상 환경이라 부를수없는 존재이기도하다.

하지만 도커는 컨테이너화된 어플리케이션을 패키징하고 배포하는 선의 작업만 가능하며 그 외에 여러 서버/클라스터에서 컨테이너를 관리하거나 실행,조정하고, 가동 시간 중지없이 어플리케이션을 업그레이드하고 배포하거나 상태를 모니터링하는걸 한번에 처리하기 힘들기 떄문에 Kubernetes(쿠버네티스),Docker Swarm 서비스(도커 스웜),Apache Mesos(아파치 메소스),HashiCorp Nomad(노마드)를 같이 사용하여 여러 컨테이너를 한번에 관리,수정,배포하게 된다.

### Kubernetes는 도커랑 뭐가 다르지?

쿠버네티스는 처음 보는 사람 입장에선 도커와 무슨 차이가 있는지 알수없다.
하지만 백엔드 개발자의 기술스택/스킬 중에 쿠버네티스가 중요한 역활을 하고있기 때문에
둘의 차이는 분명히 알아두는편이 좋을것이다.

일단 도커는 컨테이너화시킨 애플케이션을 여러개 만들더라도 결국 그걸 관리해야된다.
하지만 컨테이너화 시킨 어플리케이션이 다운되면 그걸 직접 하나씩 재실행해야된다.
이전에 사용하던 방식보다는 관리하기 쉽다고 하지만 스케일 아웃 장점떄문에 그 컨테이너 수가 수십/수백개로 늘어난다면 말이 달라진다.

그럴때 사용하는게 바로 컨테이너 오케스트레이션이다. 오케스트레이션이라는 단어는 "오케스트라(ορχήστρα)" 에서 유례된 단어이며 여러개의 컨테이너를 한번에 아래에 작성된 태스크를 실행할수있는 서비스다.

- 프로비저닝 및 배포
- 구성 및 일정 조정 
- 리소스 할당
- 컨테이너 가용성
- 인프라 전반의 워크로드 밸런싱을 기반으로 컨테이너 스케일링 또는 제거
- 로드 밸런싱 및 트래픽 라우팅 
- 컨테이너 상태 모니터링
- 실행될 컨테이너를 기반으로 애플리케이션 설정
- 컨테이너 간 상호 작용의 보안 유지

즉 컨테이너 오케스트레이션는 여러 개의 컨테이너화된 어플리케이션을 효과적으로 관리하고 배포하는데 중점을 둔 시스템이라고 보면 된다.
그 중에 많이 쓰이는 툴중 하나인 #Kubernetes 는 Google에서 개발하고 여전히 사용중인 오픈소스 컨테이너 오케스트레이션이다.

즉 쿠버네티스는 도커를 한번에 관리하기 위해 필요한 도구로 보면 된다.
그 외에도 레벨의 차이도 존재한다, 도커는 개발자 수준에서 컨테이너를 다루지만 쿠버네티스는 클러스터 수준에서 동작하기 떄문에 여러 개의 노드로 구성된 클러스터에서 컨테이너화된 애플리케이션을 관리하고 배포하는데 사용한다.

간단하게 둘의 차이를 알아봤으면 이젠 진짜 주인공인 시놀로지의 Docker에 대해 알아보도록 하자.

### 시놀로지 Docker가 특별한 이유

![Screenshot 2023-11-16 at 6.59.06 PM.png|600](/img/user/Screenshot%202023-11-16%20at%206.59.06%E2%80%AFPM.png)

- 직관적인 GUI 인터페이스와 세상 간단한 사용법
아마 시놀로지 도커만큼 개발자,일반인이 쓰기 쉬운 도커 시스템이 있을까라는 의문이 들 정도로
docker-compose,Docker Desktop보다도 훨씬 사용하기 쉽게 설계되었다.
사실 DSM 7.2 이전의 도커는 Portainer보다 떨어지는 기능이 꽤나 존재해 Portainer 컨테이너를 별도로 만들어서 거기서 도커 컨테이너를 관리하고 배포하는 사람들이 많았으나
지금부터 설명할 DSM 7.2의 Container Manager부터는 그럴 필요가 없어졌다.

### 시놀로지 Docker의 새 이름 : Container Manager

![container_manager_top_banner@2x.png|500](/img/user/container_manager_top_banner@2x.png)

바로 DSM 7.2 대규모 개편 업데이트 당시에 새로 리뉴얼된 Container Manager가 그 주인공이다.
Container Manager의 기존 이름은 "Docker" 였으며 

![01.png|500](/img/user/01.png)

이런 UI 인터페이스를 가지고있었다, 사실상 본질은 비슷하기에 이때도 쉬운 조작과 UI로 많이 사람들이 애용했으나
도커라는 이름을 달고있지만 Docker-compose와 프로젝트 기능을 자체적으로 탑재하지 않고 있어서
별도로 ssh 포트로 접근해서 Docker-compose를 수동으로 설치해주고 vim으로 Docker-compose.yml 파일을 작성해서 직접 올려야한다는 단점이 있어서 이떄 까지는 필자와 마찬가지로 대다수의 개발자가 Portainer 컨테이너를 올려서 사용 했다

### Portainer는 뭐지?

![upload_img_20230320162436_Portainer_update_container_s1.png](/img/user/upload_img_20230320162436_Portainer_update_container_s1.png)

Portainer를 도커의 컨테이너와 쿠버네티스를 쉽게 관리할수있는 웹 GUI 형태의 오픈소스 관리콘솔이다.
Docker와 Kubernetes, Docker Swarm에 대한 경험이 있다면 모두들 사용해봤을것이다.

Portainer가 있다면 구형 Docker 패키지를 사용하더라도 웹을 통해서 Docker-compose.yml 파일을 업로드하거나 작성해서 바로 올릴수있었고 관리/유지보수 면에서도 압도적으로 편했기 때문에 시놀로지 도커에는 항상 같이 쓰이던 동반자였다.

### 하지만 새로운 Container Docker는 다르다

![container_manager_top_banner@2x 1.png|500](/img/user/container_manager_top_banner@2x%201.png)

시놀로지가 이를 갈고 DMS 7.2에 새로 배포한 Container Docker는 기존의 도커와 많이 달라졌다.
훨씬 직관적으로 컨테이너 관리를 할수 있게 되었고, 개요 대시보드또한 리소스 모니터링을 하기 훨씬 적합하게 바뀌고 드디어 Compose 파일을 사용하여 프로젝트를 생성하여 운영,관리를 할수있게 되었다!!!!

![create_projects@2x.jpg|560](/img/user/create_projects@2x.jpg)

물론 이 정도 큰 변함점이 있어도 여전히 Portainer를 사용하는게 훨씬 강력한건 어쩔수없으나
그 정도의 전문성을 요구하는 직업군이나 회사 규모로 도커를 운용하는게 아닌 이상 지금의 Container Docker로도 충분한 도커 활용을 할수있을것이다
### 시놀로지 Docker의 간단한 사용법

![Screenshot 2023-11-16 at 7.17.08 PM.png|400](/img/user/Screenshot%202023-11-16%20at%207.17.08%E2%80%AFPM.png)

새로운 Container Manager에서 중요한 기능은
1. 개요
2. 프로젝트
3. 컨테이너
4. 이미지
5. 레지스트리
정도라고 볼수있다.

![Screenshot 2023-11-16 at 7.18.49 PM.png](/img/user/Screenshot%202023-11-16%20at%207.18.49%E2%80%AFPM.png)

처음으로 생긴 프로젝트 탭부터 보도록하자
매우 직관적인 UI이다. 크게 특별한건 없으니 바로 프로젝트 생성창을 보도록하자

![Screenshot 2023-11-16 at 7.18.29 PM.png|600](/img/user/Screenshot%202023-11-16%20at%207.18.29%E2%80%AFPM.png)

![Screenshot 2023-11-16 at 7.18.36 PM.png|600](/img/user/Screenshot%202023-11-16%20at%207.18.36%E2%80%AFPM.png)

DSM 7.2부터는 바로 이 창에서 compose 파일을 업로드하거나 바로 작성해서 프로젝트를 올릴수있는 혁신같은 작업을 수행할수있다. ( 이 전까지는 모두 터미널와 포트테이너를 통해서만 가능했다. )

![Screenshot 2023-11-16 at 7.18.59 PM 1.png](/img/user/Screenshot%202023-11-16%20at%207.18.59%E2%80%AFPM%201.png)

다음은 원래부터 사용했던 Docker 이미지를 사용해서 컨테이너를 만들수있는 탭이다.
이 또한 큰 차이가 없으니 바로 이미지 관리탭으로 가본다

![Screenshot 2023-11-16 at 7.19.08 PM.png|500](/img/user/Screenshot%202023-11-16%20at%207.19.08%E2%80%AFPM.png)

기존에 받았던 Docker 이미지를 바로 삭제,관리할수있다.
특별한 점이 없기에 마지막으로 이미지 다운로드탭만 확인하도록하자

![Screenshot 2023-11-16 at 7.19.19 PM.png](/img/user/Screenshot%202023-11-16%20at%207.19.19%E2%80%AFPM.png)

이미지탭에서 바로 유명한 도커 이미지를 받아와서 컨테이너를 올릴수있다.

### 시놀로지 도커의 주의사항

시놀로지 도커의 네트워크 통신은 시놀로지 나스를 거친다, 즉 시놀로지 나스에서 방화벽에 의해 해당 접속이 차단될 경우 외부에서 해당 컨테이너(서비스)에 제대로 접근할수없게 될수도있다.
그렇기에 항상 도커를 다루기전에 같이 이어야하는 CDN이나 프록시가 있다면 그전에 나스의 방화벽을 먼저 확인해보는 습관을 가지도록하자.

### 시놀로지 Docker에 간단하게 Ubuntu 올려보기

![Screenshot 2023-11-16 at 7.33.38 PM.png](/img/user/Screenshot%202023-11-16%20at%207.33.38%E2%80%AFPM.png)

1. 레지스트리탭에서 ubuntu 검색하고 다운로드

![Screenshot 2023-11-16 at 7.34.03 PM 1.png](/img/user/Screenshot%202023-11-16%20at%207.34.03%E2%80%AFPM%201.png)

2. 이미지탭에서 다운로드 완료된 ubuntu로 들어가기

![Screenshot 2023-11-16 at 7.34.19 PM.png](/img/user/Screenshot%202023-11-16%20at%207.34.19%E2%80%AFPM.png)

3. 실행 버튼 누르고 계속 다음 클릭 ( 우분투 구축시에는 건들 옵션이 없음)

![Screenshot 2023-11-16 at 7.34.37 PM.png|500](/img/user/Screenshot%202023-11-16%20at%207.34.37%E2%80%AFPM.png)

4. 요약에서 완료를 눌러 컨테이너 생성 완료.
![Screenshot 2023-11-16 at 7.36.38 PM 1.png](/img/user/Screenshot%202023-11-16%20at%207.36.38%E2%80%AFPM%201.png)
5. ssh 터미널로 나스에 접속

6. 해당 권한으로 터미널 접근

```
sudo -i
```

  7. 해당 명령어로 우분투 컨테이너가 정상적으로 실행중인지 확인
  
```
docker ps [우분투 컨테이너 ID]
```


  8. 우분투로 접근
  
```
docker attach [우분투 컨테이너 ID]
```

9. 접근 성공!
  
```
root@ubuntu-01:/# 
```

## 늅편을 마무리하며...

시놀로지의 기초도 몰랐던 사람이 이 글을 읽고 반절 이상이라도 할수있는 사람이 되길 바란다.
심화적인 파트는 담지않았으나 이 정도만 알아도 시놀로지의 잠제력의 반절 이상은 끌어올릴수있다고본다.
사실은 더 많은 내용을 담고싶었으나 체력적으로나 분량적으로나 훨씬 길어질것을 고려해서 여기서 마무리한다.

